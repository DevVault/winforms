<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <AssemblyName>System.Windows.Forms.Interop.Tests</AssemblyName>
    <Platforms>x86;x64</Platforms>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>

    <!--To suppress the build warning for test binaries caused by the mismatch in the version of WindowsBase.dll
    brought in by the xunit.stafact package and the version included in the Microsoft.Netcore.App package
    referenced by these test binaries.-->
    <MSBuildWarningsAsMessages>
      $(MSBuildWarningsAsMessages);MSB3277
    </MSBuildWarningsAsMessages>
  </PropertyGroup>

  <Import Project="ProjectReference.targets" Sdk="Microsoft.DotNet.CMake.Sdk" />

  <ItemGroup>
    <PackageReference Include="Moq" Version="$(MoqPackageVersion)" />
    <PackageReference Include="coverlet.msbuild" Version="$(CoverletMSBuildPackageVersion)" />
  </ItemGroup>

  <ItemGroup>
    <!-- xunit.stafact target TFM is contains "-windows" while our test binaris don't.
    So, we had to use this work around to load correct binary from NuGet-->
    <PackageReference Include="xunit.stafact" Version="$(XUnitStaFactPackageVersion)" ExcludeAssets="all"/>
    <Reference Include="$(PkgXunit_StaFact)\lib\net6.0-windows7.0\xunit.stafact.dll" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\..\src\System.Windows.Forms.csproj" />
    <ProjectReference Include="..\TestUtilities\System.Windows.Forms.TestUtilities.csproj" />
  </ItemGroup>

  <ItemGroup>
    <NativeProjectReference Include="NativeTests\CMakeLists.txt" CMakeProject="NativeTests\NativeTests.proj" BuildNative="true" />
  </ItemGroup>

  <Target Name="CopyTlbProjectFiles" BeforeTargets="CopyNativeProjectBinaries">
    <ItemGroup>
      <NativeProjectBinaries Include="$(NativeProjectOutputFolder)\*.tlb" />
      <NativeProjectBinaries Include="$(NativeProjectOutputFolder)\*.manifest" />
    </ItemGroup>
  </Target>

</Project>
